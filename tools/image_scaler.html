<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Image Resizer Tool</title>
  <link rel="stylesheet" href="../styles.css" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&family=Tsukimi+Rounded:wght@500;700&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0px;
    }
    #resultCanvas {
      border: 1px solid #000;
      display: block;
      margin-top: 10px;
    }
    #controls {
      margin-bottom: 10px;
    }
    textarea, select {
      width: 100%;
      margin: 10px;
      padding: 10px;
    }
    button {
      font-family: "Plus Jakarta Sans", serif;
      margin-right: 5px;
      margin-bottom: 5px;
      padding: 3px;
      cursor: pointer;
    }
    p{
      width: 50%;
    }
    input{
      font-family: "Plus Jakarta Sans", serif;
      margin: 5px;
      padding: 3px;
    }
    /* =======================
       RESPONSIVE
    ======================= */
    @media (max-width: 900px) {
      p{
      width: 100%;
    }
    }
  </style>
</head>
<body>
  <header>
  <nav class="navbar">
    <!-- Logo or site title -->
    <div class="logo">Haaan's Nifty Gadgets</div>

    <!-- The hidden checkbox that will control our nav -->
    <input type="checkbox" id="nav-toggle" class="nav-toggle" />

    <!-- The hamburger button that appears on mobile -->
    <label for="nav-toggle" class="nav-toggle-label">
      <span></span>
      <span></span>
      <span></span>
    </label>

    <!-- The main navigation menu -->
    <ul class="nav-menu">
      <li><a href="../index.html">Home</a></li>
      <li><a href="https://www.haaanly.com/">About Haaan</a></li>
      <li><a href="https://charlamainely.itch.io/">Bored?</a></li>
      <!-- Add more tools or links as needed -->
    </ul>
  </nav>
</header>
<main>
  <h2>Image Resizer Tool</h2>
  <p>This is a tool to automatically resize any image. Simply input the size you need to scale to, and paste the image you need to resize into the box at the bottom. The result can be copied with the 'copy image' button. The ratio of the image will be preserved to avoid any deformity of your original image.</p>
  <div id="controls">
    <label for="width">Width: </label>
    <input type="text" id="width" placeholder="Enter max width" />
    <label for="height">Height: </label>
    <input type="text" id="height" placeholder="Enter max height" />
    <button id="copyBtn">Copy Image</button>
  </div>
  <p>Paste an image directly from your clipboard by pressing <strong>Ctrl+V</strong></p>
  <canvas id="resultCanvas"></canvas>

  <script>
    const widthInput = document.getElementById('width');
    const heightInput = document.getElementById('height');
    const canvas = document.getElementById('resultCanvas');
    const context = canvas.getContext('2d');

    let image = new Image();

    // Paste image from clipboard
    window.addEventListener('paste', (event) => {
      const items = event.clipboardData.items;
      for (let i = 0; i < items.length; i++) {
        if (items[i].type.startsWith('image')) {
          const blob = items[i].getAsFile();
          const reader = new FileReader();
          reader.onload = function(e) {
            image.src = e.target.result;
            image.onload = () => {
              resizeImage();  // Resize immediately after pasting the image
            };
          };
          reader.readAsDataURL(blob);
        }
      }
    });

    // Trigger resize on width/height change
    widthInput.addEventListener('input', resizeImage);
    heightInput.addEventListener('input', resizeImage);

    function resizeImage() {
      if (!image.src) return;  // If no image is loaded, do nothing

      const maxWidth = parseInt(widthInput.value) || image.width;
      const maxHeight = parseInt(heightInput.value) || image.height;

      const ratio = Math.min(maxWidth / image.width, maxHeight / image.height);

      const newWidth = image.width * ratio;
      const newHeight = image.height * ratio;

      canvas.width = newWidth;
      canvas.height = newHeight;

      context.clearRect(0, 0, canvas.width, canvas.height);
      context.drawImage(image, 0, 0, newWidth, newHeight);
    }

    document.getElementById('copyBtn').addEventListener('click', () => {
      canvas.toBlob((blob) => {
        const item = new ClipboardItem({ 'image/png': blob });
        navigator.clipboard.write([item]);
        alert('Image copied to clipboard');
      });
    });
  </script>
  </main>
</body>
</html>
